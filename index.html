<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulator Examen Licență - Contabilitate</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            animation: slideIn 0.6s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 10px,
                rgba(255,255,255,0.05) 10px,
                rgba(255,255,255,0.05) 20px
            );
            animation: shimmer 20s linear infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .progress-container {
            background: #f8f9fa;
            padding: 20px 30px;
            border-bottom: 2px solid #e9ecef;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: #e9ecef;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #11998e, #38ef7d);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 6px;
        }

        .question-container {
            padding: 40px;
            min-height: 400px;
        }

        .question-number {
            color: #6c757d;
            font-size: 1.1em;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .question-text {
            font-size: 1.3em;
            line-height: 1.6;
            margin-bottom: 30px;
            color: #2c3e50;
            font-weight: 500;
        }

        .question-image {
            max-width: 100%;
            height: auto;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        .options-container {
            display: grid;
            gap: 15px;
        }

        .option {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 18px 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
            line-height: 1.5;
            position: relative;
            overflow: hidden;
        }

        .option:hover:not(.disabled) {
            background: #e3f2fd;
            border-color: #2196f3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.2);
        }

        .option.selected {
            background: #e3f2fd;
            border-color: #2196f3;
            font-weight: 600;
        }

        .option.correct {
            background: #c8e6c9;
            border-color: #4caf50;
            color: #2e7d32;
            animation: correctPulse 0.6s ease-out;
        }

        .option.incorrect {
            background: #ffcdd2;
            border-color: #f44336;
            color: #c62828;
            animation: incorrectShake 0.6s ease-out;
        }

        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        @keyframes incorrectShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .option.disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }

        .navigation {
            background: #f8f9fa;
            padding: 30px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 2px solid #e9ecef;
            flex-wrap: wrap;
            gap: 15px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            min-width: 160px;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn.danger {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
        }

        .btn.danger:hover:not(:disabled) {
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
        }

        .btn.success {
            background: linear-gradient(135deg, #28a745, #218838);
        }

        .btn.success:hover:not(:disabled) {
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4);
        }

        .score-display {
            font-size: 1.2em;
            font-weight: 600;
            color: #2c3e50;
            background: #e8f5e8;
            padding: 8px 16px;
            border-radius: 20px;
            border: 2px solid #4caf50;
        }

        .results-container {
            padding: 40px;
            text-align: center;
        }

        .final-score {
            font-size: 3em;
            font-weight: bold;
            margin: 20px 0;
            background: linear-gradient(135deg, #667eea, #764ba2);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .pass-status {
            font-size: 1.5em;
            font-weight: bold;
            margin: 20px 0;
            padding: 15px;
            border-radius: 12px;
        }

        .pass-status.pass {
            background: #c8e6c9;
            color: #2e7d32;
        }

        .pass-status.fail {
            background: #ffcdd2;
            color: #c62828;
        }

        .category-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .category-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            border-left: 5px solid #667eea;
            text-align: left;
        }

        .category-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .start-screen, .category-selection-screen {
            padding: 60px 40px;
            text-align: center;
        }

        .start-screen h2, .category-selection-screen h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 2.2em;
        }

        .exam-info {
            background: #e3f2fd;
            border-radius: 12px;
            padding: 30px;
            margin: 30px 0;
            text-align: left;
        }

        .exam-info h3 {
            color: #1976d2;
            margin-bottom: 15px;
        }

        .exam-info ul {
            color: #2c3e50;
            line-height: 1.8;
        }

        .loading-status {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            font-weight: 500;
        }

        .error-status {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            font-weight: 500;
        }

        .success-status {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            font-weight: 500;
        }

        .timer {
            font-size: 1.3em;
            font-weight: bold;
            color: #e74c3c;
            background: #ffebee;
            padding: 8px 16px;
            border-radius: 20px;
            animation: pulse 2s infinite;
        }

        .timer.warning {
            color: #ff9800;
            background: #fff3e0;
        }

        .timer.danger {
            color: #f44336;
            background: #ffebee;
            animation: fastPulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes fastPulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
        }

        .image-error {
            background: #ffebee;
            color: #c62828;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 0.9em;
            border-left: 4px solid #f44336;
        }

        .question-stats {
            display: flex;
            gap: 20px;
            font-size: 0.9em;
            color: #6c757d;
            margin-bottom: 10px;
        }

        .answered-count {
            background: #e8f5e8;
            color: #2e7d32;
            padding: 4px 12px;
            border-radius: 12px;
            font-weight: 600;
        }

        .category-selection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .category-selection-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .category-selection-card:hover {
            background: #e3f2fd;
            border-color: #2196f3;
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(33, 150, 243, 0.2);
        }

        .category-selection-card h3 {
            color: #2c3e50;
            font-size: 1.4em;
            margin-bottom: 10px;
        }

        .category-selection-card p {
            color: #6c757d;
            font-size: 1em;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 12px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .progress-info {
                font-size: 0.9em;
            }
            
            .question-container {
                padding: 20px;
            }
            
            .navigation {
                padding: 20px;
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                margin: 5px 0;
            }
        }
		
		/* Îmbunătățiri pentru mobil - adaugă aceste reguli la sfârșitul CSS-ului existent */

/* Optimizări generale pentru mobil */
@media (max-width: 768px) {
    body {
        padding: 10px;
        font-size: 16px; /* Previne zoom-ul automat pe iOS */
    }
    
    .container {
        margin: 0;
        border-radius: 12px;
        box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    
    /* Header optimizat */
    .header {
        padding: 20px 15px;
    }
    
    .header h1 {
        font-size: 1.8em;
        line-height: 1.2;
    }
    
    .header p {
        font-size: 1em;
    }
    
    /* Progress bar pentru mobil */
    .progress-container {
        padding: 15px;
    }
    
    .progress-info {
        flex-direction: column;
        gap: 8px;
        align-items: stretch;
        font-size: 0.9em;
    }
    
    .progress-info > span {
        text-align: center;
        padding: 5px;
    }
    
    .timer {
        font-size: 1.1em;
        align-self: center;
    }
    
    /* Zona de întrebări */
    .question-container {
        padding: 20px 15px;
        min-height: auto;
    }
    
    .question-text {
        font-size: 1.1em;
        line-height: 1.5;
        margin-bottom: 20px;
    }
    
    .question-stats {
        flex-direction: column;
        gap: 8px;
        font-size: 0.85em;
    }
    
    /* Opțiuni optimizate pentru touch */
    .options-container {
        gap: 12px;
    }
    
    .option {
        padding: 16px 18px;
        font-size: 1em;
        line-height: 1.4;
        min-height: 50px; /* Minim pentru touch target */
        display: flex;
        align-items: center;
        border-radius: 10px;
    }
    
    .option:hover {
        transform: none; /* Elimină hover pe mobil */
    }
    
    .option:active {
        transform: scale(0.98);
        transition: transform 0.1s;
    }
    
    /* Navigația pentru mobil */
    .navigation {
        padding: 15px;
        flex-direction: column;
        gap: 10px;
    }
    
    .btn {
        width: 100%;
        padding: 14px 20px;
        font-size: 1em;
        min-height: 50px;
        border-radius: 12px;
    }
    
    /* Ecranul de start */
    .start-screen {
        padding: 30px 20px;
    }
    
    .start-screen h2 {
        font-size: 1.6em;
        margin-bottom: 15px;
    }
    
    .exam-info {
        padding: 20px;
        margin: 20px 0;
    }
    
    .exam-info ul {
        font-size: 0.9em;
        padding-left: 20px;
    }
    
    /* Rezultatele pentru mobil */
    .results-container {
        padding: 30px 20px;
    }
    
    .final-score {
        font-size: 2.2em;
        margin: 15px 0;
    }
    
    .pass-status {
        font-size: 1.2em;
        padding: 12px;
        margin: 15px 0;
    }
    
    .category-breakdown {
        grid-template-columns: 1fr;
        gap: 15px;
        margin: 20px 0;
    }
    
    .category-card {
        padding: 15px;
    }
    
    /* Statusuri pentru mobil */
    .loading-status,
    .error-status,
    .success-status {
        padding: 12px;
        font-size: 0.9em;
        margin: 15px 0;
    }

    .category-selection-screen {
        padding: 30px 20px;
    }
    .category-selection-grid {
        grid-template-columns: 1fr;
    }
    .category-selection-card {
        padding: 20px;
    }
    .category-selection-card h3 {
        font-size: 1.2em;
    }
}

/* Pentru telefoane foarte mici */
@media (max-width: 480px) {
    .header h1 {
        font-size: 1.5em;
    }
    
    .progress-info {
        font-size: 0.8em;
    }
    
    .question-text {
        font-size: 1em;
    }
    
    .option {
        padding: 14px 16px;
        font-size: 0.95em;
    }
    
    .btn {
        padding: 12px 16px;
        font-size: 0.95em;
    }
    
    .final-score {
        font-size: 2em;
    }
}

/* Landscape pe telefon */
@media (max-width: 768px) and (orientation: landscape) {
    .header {
        padding: 15px;
    }
    
    .header h1 {
        font-size: 1.6em;
    }
    
    .question-container {
        padding: 15px;
    }
    
    .navigation {
        flex-direction: row;
        justify-content: space-between;
    }
    
    .btn {
        width: auto;
        min-width: 120px;
        flex: 1;
        margin: 0 5px;
    }
}

/* Îmbunătățiri pentru touch și accesibilitate */
@media (max-width: 768px) {
    /* Mărește zona de touch pentru butoane mici */
    .progress-info span {
        padding: 8px;
        border-radius: 6px;
    }
    
    .answered-count,
    .score-display {
        font-size: 0.9em;
        padding: 6px 12px;
    }
    
    /* Scroll smooth pentru conținut lung */
    .question-container {
        scroll-behavior: smooth;
    }
    
    /* Focus vizibil pentru accesibilitate */
    .option:focus,
    .btn:focus {
        outline: 2px solid #4facfe;
        outline-offset: 2px;
    }
}

/* Îmbunătățiri pentru imagini pe mobil */
@media (max-width: 768px) {
    .question-image {
        max-width: 100%;
        height: auto;
        margin: 15px 0;
        border-radius: 6px;
    }
    
    .image-error {
        font-size: 0.85em;
        padding: 8px;
        margin: 10px 0;
    }
}

/* Dark mode pentru mobil (opțional) */
@media (max-width: 768px) and (prefers-color-scheme: dark) {
    .container {
        background: #1a1a1a;
        color: #ffffff;
    }
    
    .option {
        background: #2d2d2d;
        border-color: #404040;
        color: #ffffff;
    }
    
    .question-text {
        color: #ffffff;
    }
}
		
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎓 Simulator Examen Licență</h1>
            <p>Contabilitate și Informatică de Gestiune</p>
        </div>

        <div id="startScreen" class="start-screen">
            <h2>Pregătește-te pentru Examenul de Licență!</h2>
            <div class="exam-info">
                <h3>📋 Detalii Examen:</h3>
                <ul>
                    <li><strong>Numărul de întrebări:</strong> 90 întrebări</li>
                    <li><strong>Punctaj pornire:</strong> 10 puncte din oficiu</li>
                    <li><strong>Contabilitate Financiară:</strong> 60 întrebări (aleatoriu)</li>
                    <li><strong>Baze de Date + Sisteme Informatice:</strong> 30 întrebări (aleatoriu)</li>
                    <li><strong>Punctaj maxim:</strong> 100 puncte</li>
                    <li><strong>Nota de trecere:</strong> 60 puncte</li>
                    <li><strong>Timp disponibil:</strong> 180 minute (3 ore)</li>
                </ul>
            </div>
            
            <div id="loadingStatus" class="loading-status" style="display: none;">
                ⏳ Se încarcă întrebările din fișierul JSON...
            </div>
            
            <div id="errorStatus" class="error-status" style="display: none;">
                ❌ Nu s-a putut încărca fișierul "intrebari-raspunsuri.json". Verificați că fișierul există și este valid.
            </div>
            
            <div id="successStatus" class="success-status" style="display: none;">
                ✅ Întrebările au fost încărcate cu succes!
            </div>
            
            <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin-top: 30px;">
                <button class="btn" id="startBtn" onclick="startExam()" disabled>🚀 Începe Examenul</button>
                <button class="btn success" id="practiceBtn" onclick="showCategorySelection()" disabled>📚 Repetă Întrebările</button>
            </div>
        </div>

        <div id="categorySelectionScreen" class="category-selection-screen" style="display: none;">
            <h2>Alege o categorie pentru practică</h2>
            <div class="category-selection-grid" id="categorySelectionGrid">
                </div>
            <button class="btn danger" onclick="goBackToStart()">Înapoi</button>
        </div>

        <div id="examContainer" style="display: none;">
            <div class="progress-container">
                <div class="progress-info">
                    <span>Întrebarea <span id="questionNumber">1</span> din <span id="totalQuestions">90</span></span>
                    <span class="answered-count">Răspunse: <span id="answeredCount">0</span></span>
                    <span class="score-display">Punctaj: <span id="currentScore">10</span>/<span id="maxScoreDisplay">100</span></span>
                    <span class="timer" id="timer">03:00:00</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>

            <div class="question-container">
                <div class="question-stats">
                    <span>Categoria: <strong id="questionCategory"></strong></span>
                    <span id="questionType"></span>
                </div>
                <div class="question-number" id="questionNumberDisplay">
                    Întrebarea 1 din 90
                </div>
                <div class="question-text" id="questionText"></div>
                <div id="questionImageContainer"></div>
                <div class="options-container" id="optionsContainer"></div>
            </div>

            <div class="navigation">
                <button class="btn" id="prevBtn" onclick="previousQuestion()" disabled>⬅ Precedenta</button>
                <button class="btn danger" onclick="finishExam()">🏁 Finalizează Anticipat</button>
                <button class="btn" id="nextBtn" onclick="nextQuestion()">Următoarea ➡</button>
            </div>
        </div>

        <div id="resultsScreen" style="display: none;">
            <div class="results-container">
                <h2 id="resultsTitle">🎉 Examen Finalizat!</h2>
                <div class="final-score" id="finalScore">85/100</div>
                <div class="pass-status" id="passStatus">✅ PROMOVAT</div>
                <div class="category-breakdown" id="categoryBreakdown"></div>
                <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin-top: 30px;">
                    <button class="btn" onclick="restartExam()">🔄 Încearcă din nou</button>
                    <button class="btn" onclick="reviewAnswers()">📋 Revizuiește Răspunsurile</button>
                    <button class="btn danger" onclick="goBackToStart()">🏠 Acasă</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variabile globale
        let questionsData = [];
        let isQuestionsLoaded = false;
        let allQuestions = [];
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let score = 0; 
        let timeLeft = 180 * 60; // 3 ore în secunde
        let timerInterval;
        let examMode = 'exam'; // 'exam' or 'practice'
        let practiceCategory = ''; // 'CONTABILITATE FINANCIARA' or 'INFORMATICA'

        // Funcție pentru încărcarea întrebărilor din fișierul JSON
        async function loadQuestionsFromFile() {
            const loadingStatus = document.getElementById('loadingStatus');
            const errorStatus = document.getElementById('errorStatus');
            const successStatus = document.getElementById('successStatus');
            const startBtn = document.getElementById('startBtn');
            const practiceBtn = document.getElementById('practiceBtn');

            loadingStatus.style.display = 'block';
            errorStatus.style.display = 'none';
            successStatus.style.display = 'none';
            startBtn.disabled = true;
            practiceBtn.disabled = true;

            try {
                const response = await fetch('intrebari-raspunsuri.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                questionsData = await response.json();
                isQuestionsLoaded = true;
                
                loadingStatus.style.display = 'none';
                successStatus.style.display = 'block';
                successStatus.innerHTML = `✅ Încărcate ${questionsData.length} întrebări din fișierul JSON`;
                
                startBtn.disabled = false;
                practiceBtn.disabled = false;
                
                console.log(`✅ Încărcate ${questionsData.length} întrebări din fișierul JSON`);
                return true;
            } catch (error) {
                console.error('❌ Eroare la încărcarea fișierului JSON:', error);
                
                loadingStatus.style.display = 'none';
                errorStatus.style.display = 'block';
                errorStatus.innerHTML = `❌ Nu s-a putut încărca fișierul "intrebari-raspunsuri.json".<br>
                    Detalii eroare: ${error.message}<br>
                    <small>Verificați că fișierul există în același director cu HTML-ul și că este valid JSON.</small>`;
                
                startBtn.disabled = true;
                practiceBtn.disabled = true;
                isQuestionsLoaded = false;
                return false;
            }
        }

        // Funcție pentru pregătirea întrebărilor de examen
        function prepareExamQuestions() {
            allQuestions.length = 0; // Clear existing questions
            
            // Filtrează întrebările pe categorii
            const contabilitateFinanciara = questionsData.filter(q => 
                q.category === "CONTABILITATE FINANCIARA" || 
                q.category === "CONTABILITATE FINANCIARĂ"
            );
            const bazeDate = questionsData.filter(q => 
                q.category === "BAZE DE DATE" || 
                q.category.includes("BAZE")
            );
            const sistemeInformatice = questionsData.filter(q => 
                q.category === "SISTEME INFORMATICE DE GESTIUNE" || 
                q.category.includes("SISTEME")
            );
            
            console.log(`Categorii găsite:`);
            console.log(`- Contabilitate Financiară: ${contabilitateFinanciara.length}`);
            console.log(`- Baze de Date: ${bazeDate.length}`);
            console.log(`- Sisteme Informatice: ${sistemeInformatice.length}`);
            
            // Verifică dacă avem suficiente întrebări
            if (contabilitateFinanciara.length < 60) {
                throw new Error(`Nu sunt suficiente întrebări pentru Contabilitate Financiară. Găsite: ${contabilitateFinanciara.length}, necesare: 60`);
            }
            
            const alteleIntrebari = [...bazeDate, ...sistemeInformatice];
            if (alteleIntrebari.length < 30) {
                throw new Error(`Nu sunt suficiente întrebări pentru celelalte categorii. Găsite: ${alteleIntrebari.length}, necesare: 30`);
            }

            // Amestecă întrebările în fiecare categorie
            shuffleArray(contabilitateFinanciara);
            shuffleArray(alteleIntrebari);

            // Selectează întrebările necesare
            for (let i = 0; i < 60; i++) {
                const question = { ...contabilitateFinanciara[i] };
                question.id = `cf_${i}`;
                question.questionNumber = i + 1;
                allQuestions.push(question);
            }

            for (let i = 0; i < 30; i++) {
                const question = { ...alteleIntrebari[i] };
                question.id = `other_${i}`;
                question.questionNumber = i + 61;
                allQuestions.push(question);
            }
            
            // Amestecă toate întrebările pentru examen
            shuffleArray(allQuestions);
            
            // Renumerotează întrebările după amestecare
            allQuestions.forEach((q, index) => {
                q.examOrder = index + 1;
            });
            
            console.log(`✅ Pregătite ${allQuestions.length} întrebări pentru examen`);
            console.log(`- Contabilitate Financiară: ${allQuestions.filter(q => q.category.includes('CONTABILITATE')).length}`);
            console.log(`- Alte categorii: ${allQuestions.filter(q => !q.category.includes('CONTABILITATE')).length}`);
        }

        function preparePracticeQuestions(category) {
            allQuestions.length = 0; // Clear existing questions
            let filteredQuestions = [];

            if (category === 'CONTABILITATE FINANCIARA') {
                filteredQuestions = questionsData.filter(q => 
                    q.category === "CONTABILITATE FINANCIARA" || 
                    q.category === "CONTABILITATE FINANCIARĂ"
                );
            } else if (category === 'INFORMATICA') {
                filteredQuestions = questionsData.filter(q => 
                    q.category === "BAZE DE DATE" || 
                    q.category.includes("BAZE") ||
                    q.category === "SISTEME INFORMATICE DE GESTIUNE" || 
                    q.category.includes("SISTEME")
                );
            }

            shuffleArray(filteredQuestions);
            allQuestions = filteredQuestions.map((q, index) => ({
                ...q,
                id: `practice_${index}`,
                questionNumber: index + 1,
                examOrder: index + 1
            }));

            console.log(`✅ Pregătite ${allQuestions.length} întrebări pentru practică în categoria: ${category}`);
        }

        async function startExam() {
            const startBtn = document.getElementById('startBtn');
            const originalText = startBtn.innerHTML;
            startBtn.innerHTML = '⏳ Se pregătește examenul...';
            startBtn.disabled = true;
            document.getElementById('practiceBtn').disabled = true;

            try {
                // Load questions if not already loaded
                if (!isQuestionsLoaded) {
                    await loadQuestionsFromFile();
                }

                if (!isQuestionsLoaded) {
                    throw new Error('Nu s-au putut încărca întrebările');
                }

                examMode = 'exam';
                score = 10; // 10 puncte din oficiu pentru modul examen
                document.getElementById('maxScoreDisplay').textContent = '100';
                prepareExamQuestions();
                
                // Hide start screen and show exam
                document.getElementById('startScreen').style.display = 'none';
                document.getElementById('examContainer').style.display = 'block';
                
                // Initialize answers array  
                userAnswers = new Array(allQuestions.length).fill(null);
                
                // Start timer
                timeLeft = 180 * 60; // Reset timer for exam mode
                startTimer();
                
                // Display first question
                displayQuestion();
                
            } catch (error) {
                console.error('Eroare la pornirea examenului:', error);
                alert(`Eroare la pornirea examenului: ${error.message}`);
                startBtn.innerHTML = originalText;
                startBtn.disabled = false;
                document.getElementById('practiceBtn').disabled = false;
            }
        }

        function startPractice(category) {
            if (!isQuestionsLoaded) {
                alert('Întrebările nu sunt încărcate. Vă rugăm așteptați.');
                return;
            }

            examMode = 'practice';
            practiceCategory = category;
            score = 0; // Punctaj de pornire 0 pentru modul practică

            preparePracticeQuestions(category);

            document.getElementById('maxScoreDisplay').textContent = allQuestions.length;
            document.getElementById('currentScore').textContent = score;
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('categorySelectionScreen').style.display = 'none';
            document.getElementById('examContainer').style.display = 'block';

            userAnswers = new Array(allQuestions.length).fill(null);

            // Stop and hide timer for practice mode
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            document.getElementById('timer').textContent = 'PRACTICĂ';
            document.getElementById('timer').className = 'timer';

            displayQuestion();
        }

        function showCategorySelection() {
            if (!isQuestionsLoaded) {
                alert('Întrebările nu sunt încărcate. Vă rugăm așteptați.');
                return;
            }
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('categorySelectionScreen').style.display = 'block';

            const categoryGrid = document.getElementById('categorySelectionGrid');
            categoryGrid.innerHTML = '';

            const contabilitateFinanciaraCount = questionsData.filter(q => 
                q.category === "CONTABILITATE FINANCIARA" || q.category === "CONTABILITATE FINANCIARĂ"
            ).length;
            const informaticaCount = questionsData.filter(q => 
                q.category === "BAZE DE DATE" || q.category.includes("BAZE") ||
                q.category === "SISTEME INFORMATICE DE GESTIUNE" || q.category.includes("SISTEME")
            ).length;

            const categories = [
                { id: 'CONTABILITATE FINANCIARA', name: 'Contabilitate Financiară', count: contabilitateFinanciaraCount },
                { id: 'INFORMATICA', name: 'Informatică (Baze de Date + S.I.G.)', count: informaticaCount }
            ];

            categories.forEach(cat => {
                const card = document.createElement('div');
                card.className = 'category-selection-card';
                card.onclick = () => startPractice(cat.id);
                card.innerHTML = `
                    <h3>${cat.name}</h3>
                    <p>Întrebări disponibile: ${cat.count}</p>
                `;
                categoryGrid.appendChild(card);
            });
        }

        function goBackToStart() {
            document.getElementById('categorySelectionScreen').style.display = 'none';
            document.getElementById('examContainer').style.display = 'none';
            document.getElementById('resultsScreen').style.display = 'none';
            document.getElementById('startScreen').style.display = 'block';

            // Ensure buttons are correctly enabled/disabled
            document.getElementById('startBtn').disabled = !isQuestionsLoaded;
            document.getElementById('practiceBtn').disabled = !isQuestionsLoaded;
            document.getElementById('startBtn').innerHTML = '🚀 Începe Examenul';
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    finishExam();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            if (examMode === 'practice') {
                document.getElementById('timer').textContent = 'PRACTICĂ';
                document.getElementById('timer').className = 'timer';
                return;
            }

            const hours = Math.floor(timeLeft / 3600);
            const minutes = Math.floor((timeLeft % 3600) / 60);
            const seconds = timeLeft % 60;
            
            const timerElement = document.getElementById('timer');
            const timeString = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            timerElement.textContent = timeString;
            
            // Change timer color based on remaining time
            if (timeLeft <= 600) { // 10 minutes
                timerElement.className = 'timer danger';
            } else if (timeLeft <= 1800) { // 30 minutes
                timerElement.className = 'timer warning';
            } else {
                timerElement.className = 'timer';
            }
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // Funcția lipsă pentru actualizarea numărului de răspunsuri
        function updateAnsweredCount() {
            const answeredCount = userAnswers.filter(answer => answer !== null).length;
            document.getElementById('answeredCount').textContent = answeredCount;
        }

        function displayQuestion() {
            const question = allQuestions[currentQuestionIndex];
            
            document.getElementById('questionNumber').textContent = currentQuestionIndex + 1;
            document.getElementById('totalQuestions').textContent = allQuestions.length;
            document.getElementById('questionCategory').textContent = question.category;
            document.getElementById('questionNumberDisplay').textContent = `Întrebarea ${currentQuestionIndex + 1} din ${allQuestions.length}`;
            document.getElementById('questionText').innerHTML = question.question;
            
            // Update question type display
            const questionType = question.category.includes('CONTABILITATE') ? 
                '📊 Contabilitate Financiară' : 
                question.category.includes('BAZE') ? '🗄️ Baze de Date' : '💻 Sisteme Informatice';
            document.getElementById('questionType').textContent = questionType;
            
            // Handle question image
            const imageContainer = document.getElementById('questionImageContainer');
            imageContainer.innerHTML = '';
            
            if (question.image) {
                const img = document.createElement('img');
                img.src = question.image;
                img.className = 'question-image';
                img.alt = 'Imagine pentru întrebare';
                
                img.onerror = function() {
                    imageContainer.innerHTML = `
                        <div class="image-error">
                            ⚠️ Nu s-a putut încărca imaginea: ${question.image}
                        </div>
                    `;
                };
                
                imageContainer.appendChild(img);
            }
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.innerHTML = option;
                optionDiv.onclick = () => selectAnswer(index);
                
                // Restore previous selection and state
                if (userAnswers[currentQuestionIndex] !== null) {
                    const userAnswer = userAnswers[currentQuestionIndex];
                    const correctAnswerIndex = ['a', 'b', 'c', 'd'].indexOf(question.answer);
                    
                    optionDiv.classList.add('disabled');
                    
                    if (index === userAnswer) {
                        optionDiv.classList.add('selected');
                        if (userAnswer === correctAnswerIndex) {
                            optionDiv.classList.add('correct');
                        } else {
                            optionDiv.classList.add('incorrect');
                        }
                    }
                    
                    if (index === correctAnswerIndex && userAnswer !== correctAnswerIndex) {
                        optionDiv.classList.add('correct');
                    }
                }
                
                optionsContainer.appendChild(optionDiv);
            });
            
            updateProgress();
            updateNavigationButtons();
            updateAnsweredCount();
        }

        function selectAnswer(optionIndex) {
            const options = document.querySelectorAll('.option');
            const question = allQuestions[currentQuestionIndex];
            
            // Don't allow selection if already answered
            if (userAnswers[currentQuestionIndex] !== null) {
                return;
            }
            
            // Disable all options
            options.forEach(opt => {
                opt.classList.add('disabled');
            });
            
            // Mark selected answer
            options[optionIndex].classList.add('selected');
            

            // Show correct/incorrect
            const correctAnswerIndex = ['a', 'b', 'c', 'd'].indexOf(question.answer);
			if (optionIndex === correctAnswerIndex) {
                options[optionIndex].classList.add('correct');
                score += 1; // Add 1 point for correct answer
            } else {
                options[optionIndex].classList.add('incorrect');
                // Show correct answer
                options[correctAnswerIndex].classList.add('correct');
            }
            
            // Store answer
            userAnswers[currentQuestionIndex] = optionIndex;
            
            // Update score display
            document.getElementById('currentScore').textContent = score;
            
            // Update answered count
            updateAnsweredCount();
        }

        function updateProgress() {
            const progress = ((currentQuestionIndex + 1) / allQuestions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function updateNavigationButtons() {
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            document.getElementById('nextBtn').disabled = false;
            
            if (currentQuestionIndex === allQuestions.length - 1) {
                document.getElementById('nextBtn').textContent = '🏁 Finalizează';
            } else {
                document.getElementById('nextBtn').textContent = 'Următoarea ➡';
            }
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (currentQuestionIndex < allQuestions.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                finishExam();
            }
        }

        function finishExam() {
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            calculateFinalResults();
            showResults();
        }

        function calculateFinalResults() {
            let correctAnswers = 0;
            let categoryScores = {};
            
            // Initialize category counters
            const categories = ['CONTABILITATE FINANCIARA', 'BAZE DE DATE', 'SISTEME INFORMATICE DE GESTIUNE'];
            categories.forEach(cat => {
                categoryScores[cat] = { correct: 0, total: 0 };
            });
            
            allQuestions.forEach((question, index) => {
                const userAnswer = userAnswers[index];
                const correctAnswerIndex = ['a', 'b', 'c', 'd'].indexOf(question.answer);
                
                // Find category key (normalize for comparison)
                let categoryKey = question.category.toUpperCase();
                if (categoryKey.includes('CONTABILITATE')) {
                    categoryKey = 'CONTABILITATE FINANCIARA';
                } else if (categoryKey.includes('BAZE')) {
                    categoryKey = 'BAZE DE DATE';
                } else if (categoryKey.includes('SISTEME')) {
                    categoryKey = 'SISTEME INFORMATICE DE GESTIUNE';
                }
                
                if (!categoryScores[categoryKey]) {
                    categoryScores[categoryKey] = { correct: 0, total: 0 };
                }
                
                categoryScores[categoryKey].total++;
                
                if (userAnswer === correctAnswerIndex) {
                    correctAnswers++;
                    categoryScores[categoryKey].correct++;
                }
            });
            
            // Final score depends on exam mode
            if (examMode === 'exam') {
                score = 10 + correctAnswers; // 10 points from office
            } else { // practice mode
                score = correctAnswers; // Score is just correct answers
            }
            
            // Store results for display
            window.examResults = {
                finalScore: score,
                correctAnswers: correctAnswers,
                totalQuestions: allQuestions.length,
                categoryScores: categoryScores,
                passed: examMode === 'exam' ? score >= 60 : (correctAnswers / allQuestions.length) >= 0.6 // For practice, pass if >= 60%
            };
        }

        function showResults() {
            document.getElementById('examContainer').style.display = 'none';
            document.getElementById('resultsScreen').style.display = 'block';
            
            const results = window.examResults;
            
            document.getElementById('finalScore').textContent = `${results.finalScore}/${examMode === 'exam' ? '100' : results.totalQuestions}`;
            
            const passStatus = document.getElementById('passStatus');
            const resultsTitle = document.getElementById('resultsTitle');

            if (examMode === 'exam') {
                resultsTitle.textContent = '🎉 Examen Finalizat!';
                if (results.passed) {
                    passStatus.textContent = '✅ PROMOVAT';
                    passStatus.className = 'pass-status pass';
                } else {
                    passStatus.textContent = '❌ RESPINS';
                    passStatus.className = 'pass-status fail';
                }
            } else { // practice mode
                resultsTitle.textContent = `Practică Finalizată - ${practiceCategory === 'CONTABILITATE FINANCIARA' ? 'Contabilitate' : 'Informatică'}`;
                const percentage = ((results.correctAnswers / results.totalQuestions) * 100).toFixed(1);
                passStatus.textContent = `Răspunsuri corecte: ${results.correctAnswers}/${results.totalQuestions} (${percentage}%)`;
                passStatus.className = 'pass-status ' + (results.passed ? 'pass' : 'fail'); // Use same pass/fail colors
            }

            // Display category breakdown
            const breakdown = document.getElementById('categoryBreakdown');
            breakdown.innerHTML = '';
            
            if (examMode === 'exam') {
                Object.keys(results.categoryScores).forEach(category => {
                    const data = results.categoryScores[category];
                    if (data.total > 0) {
                        const percentage = ((data.correct / data.total) * 100).toFixed(1);
                        const card = document.createElement('div');
                        card.className = 'category-card';
                        card.innerHTML = `
                            <div class="category-title">${category}</div>
                            <div>Corecte: ${data.correct}/${data.total} (${percentage}%)</div>
                            <div style="font-size: 0.9em; color: #6c757d; margin-top: 5px;">
                                Puncte obținute: ${data.correct}
                            </div>
                        `;
                        breakdown.appendChild(card);
                    }
                });
            } else { // Practice mode breakdown
                const data = results.categoryScores[practiceCategory];
                if (data && data.total > 0) {
                    const percentage = ((data.correct / data.total) * 100).toFixed(1);
                    const card = document.createElement('div');
                    card.className = 'category-card';
                    card.innerHTML = `
                        <div class="category-title">${practiceCategory === 'CONTABILITATE FINANCIARA' ? 'Contabilitate Financiară' : 'Informatică'}</div>
                        <div>Corecte: ${data.correct}/${data.total} (${percentage}%)</div>
                    `;
                    breakdown.appendChild(card);
                } else if (practiceCategory === 'INFORMATICA') {
                    // For Informatica, show breakdown of sub-categories if possible
                    const bazeDateData = results.categoryScores['BAZE DE DATE'] || { correct: 0, total: 0 };
                    const sistemeInformaticeData = results.categoryScores['SISTEME INFORMATICE DE GESTIUNE'] || { correct: 0, total: 0 };

                    if (bazeDateData.total > 0) {
                        const bdPercentage = ((bazeDateData.correct / bazeDateData.total) * 100).toFixed(1);
                        const bdCard = document.createElement('div');
                        bdCard.className = 'category-card';
                        bdCard.innerHTML = `
                            <div class="category-title">Baze de Date</div>
                            <div>Corecte: ${bazeDateData.correct}/${bazeDateData.total} (${bdPercentage}%)</div>
                        `;
                        breakdown.appendChild(bdCard);
                    }
                    if (sistemeInformaticeData.total > 0) {
                        const sigPercentage = ((sistemeInformaticeData.correct / sistemeInformaticeData.total) * 100).toFixed(1);
                        const sigCard = document.createElement('div');
                        sigCard.className = 'category-card';
                        sigCard.innerHTML = `
                            <div class="category-title">Sisteme Informatice de Gestiune</div>
                            <div>Corecte: ${sistemeInformaticeData.correct}/${sistemeInformaticeData.total} (${sigPercentage}%)</div>
                        `;
                        breakdown.appendChild(sigCard);
                    }
                }
            }
        }

        function restartExam() {
            // Reset all variables
            currentQuestionIndex = 0;
            userAnswers = [];
            score = 0; // Will be set to 10 or 0 based on examMode
            timeLeft = 180 * 60;
            
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            // Hide results and show start screen
            document.getElementById('resultsScreen').style.display = 'none';
            document.getElementById('startScreen').style.display = 'block';
            
            // Reset start and practice buttons
            const startBtn = document.getElementById('startBtn');
            const practiceBtn = document.getElementById('practiceBtn');
            startBtn.disabled = !isQuestionsLoaded;
            practiceBtn.disabled = !isQuestionsLoaded;
            startBtn.innerHTML = '🚀 Începe Examenul';

            // Reset max score display for next exam/practice
            document.getElementById('maxScoreDisplay').textContent = '100'; 
        }

        function reviewAnswers() {
            // Hide results and show exam in review mode
            document.getElementById('resultsScreen').style.display = 'none';
            document.getElementById('examContainer').style.display = 'block';
            
            // Reset to first question
            currentQuestionIndex = 0;
            displayQuestion();
            
            // Disable timer in review mode
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            document.getElementById('timer').textContent = 'REVIZUIRE';
            document.getElementById('timer').className = 'timer';
            
            // Update navigation for review mode
            document.getElementById('nextBtn').textContent = 'Următoarea ➡';
            document.getElementById('nextBtn').onclick = () => {
                if (currentQuestionIndex < allQuestions.length - 1) {
                    currentQuestionIndex++;
                    displayQuestion();
                } else {
                    alert('Ai parcurs toate întrebările în modul revizuire.');
                }
            };
            document.getElementById('prevBtn').onclick = () => {
                if (currentQuestionIndex > 0) {
                    currentQuestionIndex--;
                    displayQuestion();
                }
            };
            document.querySelector('.navigation .btn.danger').style.display = 'none'; // Hide Finish Exam button
        }

        // Load questions when page loads
        window.addEventListener('load', function() {
            loadQuestionsFromFile();
        });

        // Prevent accidental page refresh during exam
        window.addEventListener('beforeunload', function (e) {
            if (document.getElementById('examContainer').style.display !== 'none' && examMode === 'exam') {
                e.preventDefault();
                e.returnValue = '';
            }
        });
    </script>
</body>
</html>
